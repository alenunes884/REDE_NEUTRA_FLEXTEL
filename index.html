<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatório de VLANs e OLTs</title>
    
    <!-- React and ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- html2pdf.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" xintegrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        
        /* Animação apenas para tela, não para PDF */
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Ajuste crucial para o PDF não sair branco */
        .pdf-hidden-container {
            position: fixed;
            left: -10000px; /* Move para o lado em vez de muito para cima */
            top: 0;
            width: 800px; /* Largura fixa A4 aprox */
            background-color: white;
            z-index: -100;
            opacity: 1 !important; /* Força opacidade total */
            visibility: visible !important; /* Força visibilidade */
        }

        /* Estilos específicos para impressão/PDF para garantir contraste */
        .pdf-mode {
            background-color: white !important;
            color: black !important;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- Ícones SVG embutidos ---
        const Icons = {
            Server: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="20" height="8" x="2" y="2" rx="2" ry="2"/><rect width="20" height="8" x="2" y="14" rx="2" ry="2"/><line x1="6" x2="6.01" y1="6" y2="6"/><line x1="6" x2="6.01" y1="18" y2="18"/></svg>
            ),
            Info: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
            ),
            ArrowUpCircle: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="m16 12-4-4-4 4"/><path d="M12 16V8"/></svg>
            ),
            Network: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="16" y="16" width="6" height="6" rx="1"/><rect x="2" y="16" width="6" height="6" rx="1"/><rect x="9" y="2" width="6" height="6" rx="1"/><path d="M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3"/><path d="M12 12V8"/></svg>
            ),
            Activity: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
            ),
            Cpu: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><path d="M15 2v2"/><path d="M15 20v2"/><path d="M2 15h2"/><path d="M2 9h2"/><path d="M20 15h2"/><path d="M20 9h2"/><path d="M9 2v2"/><path d="M9 20v2"/></svg>
            ),
            Box: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>
            ),
            Loader2: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
            ),
            Download: ({ size = 24, className }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
            )
        };

        const zteData = [
            {
                name: "OLT-JDAEROPORTO-FLEXTEL",
                model: "ZTE",
                vlans: [
                    { id: 1040, name: "PPPoE_NETWARE", desc: "PPPoE_JDAEROPORTO_NETWARE", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Detectado (gpon-onu_1/3/2...)" },
                    { id: 1343, name: "PPPoE_CDLPLUS", desc: "PPPoE_JDAEROPORTO_CDLPLUS", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Detectado (gpon-onu_1/3/13...)" }
                ]
            },
            {
                name: "OLT-CAICARA-67INTERNET",
                model: "ZTE",
                vlans: [
                    { id: 150, name: "PPPoE_TOPNET", desc: "PPPoE_CAICARA_TOPNET", uplinks: ["xgei_1/19/1"], gpon: "Detectado (Múltiplas ONUs)" },
                    { id: 1347, name: "PPPoE_CDLPLUS", desc: "PPPoE_CAICARA_CDLPLUS", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Detectado (Múltiplas ONUs)" },
                    { id: 1394, name: "PPPoE_I9", desc: "PPPoE_I9_CAICARA", uplinks: ["xgei_1/19/1"], gpon: "Detectado (Múltiplas ONUs)" }
                ]
            },
            {
                name: "OLT-JDINAPOLIS-FLEXTEL",
                model: "ZTE",
                vlans: [
                    { id: 150, name: "PPPoE_TOPNET", desc: "PPPoE_JDINAPOLIS_TOPNET", uplinks: ["xgei_1/19/1"], gpon: "Detectado (Múltiplas ONUs)" },
                    { id: 1345, name: "PPPoE_CDLPLUS", desc: "PPPoE_JDINAPOLIS_CDLPLUS", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Configurado" },
                    { id: 1397, name: "PPPoE_I9", desc: "N/A (Snippet cortado)", uplinks: ["N/A"], gpon: "Configurado" },
                    { id: 4014, name: "PPPoE_CBNET", desc: "PPPoE_JDINAPOLIS_CBNET", uplinks: ["N/A"], gpon: "Detectado (gpon-onu_1/2/1...)" }
                ]
            },
            {
                name: "OLT-JDTIJUCA-FLEXTEL",
                model: "ZTE",
                vlans: [
                    { id: 150, name: "PPPoE_TOPNET", desc: "PPPoE_JDTIJUCA_TOPNET", uplinks: ["N/A"], gpon: "Detectado (Alta densidade de ONUs)" }
                ]
            },
            {
                name: "OLT-NASSER-WIFINET",
                model: "ZTE",
                vlans: [
                    { id: 150, name: "PPPoE_TOPNET", desc: "PPPoE_NASSER_TOPNET", uplinks: ["xgei_1/19/1"], gpon: "Detectado (Múltiplas ONUs)" },
                    { id: 1341, name: "PPPoE_CDLPLUS", desc: "PPPoE_NASSER_CDLPLUS", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Detectado (gpon-onu_1/5/10...)" }
                ]
            },
            {
                name: "OLT-NCG-WIFINET",
                model: "ZTE",
                vlans: [
                    { id: 150, name: "PPPoE_TOPNET", desc: "PPPoE_NCG_TOPNET", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Detectado (Múltiplas ONUs)" },
                    { id: 1040, name: "PPPoE_NETWARE", desc: "PPPoE_NCG_NETWARE", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Detectado" },
                    { id: 1344, name: "PPPoE_CDLPLUS", desc: "PPPoE_NCG_CDLPLUS", uplinks: ["N/A"], gpon: "Configurado" }
                ]
            },
            {
                name: "OLT-STAEMILIA-FLEXTEL",
                model: "ZTE",
                vlans: [
                    { id: 150, name: "PPPoE_TOPNET", desc: "PPPoE_STAEMILIA_TOPNET", uplinks: ["N/A"], gpon: "Detectado" },
                    { id: 4014, name: "PPPoE_CBNET", desc: "PPPoE_STAEMILIA_CBNET", uplinks: ["N/A"], gpon: "Detectado" }
                ]
            },
            {
                name: "OLT-STOAMARO-67INTERNET",
                model: "ZTE",
                vlans: [
                    { id: 150, name: "PPPoE_TOPNET", desc: "PPPoE_STOAMARO_TOPNET", uplinks: ["xgei_1/19/1"], gpon: "Detectado" },
                    { id: 1342, name: "PPPoE_CDLPLUS", desc: "PPPoE_STOAMARO_CDLPLUS", uplinks: ["xgei_1/19/1", "xgei_1/20/1"], gpon: "Configurado" },
                    { id: 1393, name: "PPPoE_I9", desc: "PPPoE_STOAMARO...", uplinks: ["N/A"], gpon: "Configurado" }
                ]
            }
        ];

        const huaweiData = [
            {
                name: "OLT-CAMPONOBRE-JPNET",
                model: "HUAWEI",
                note: "display vlan all / desc. Alta densidade em VLANs 100, 103, 150.",
                vlans: [
                    { id: 1, type: "smart", servPorts: 0, desc: "Default" },
                    { id: 11, type: "standard", servPorts: 0, desc: "-" },
                    { id: 100, type: "smart", servPorts: 816, desc: "PPPoE_CAMPONOBRE_JPNET" },
                    { id: 102, type: "smart", servPorts: 79, desc: "PPPoE_CAMPONOBRE_67INTERNET" },
                    { id: 103, type: "smart", servPorts: 366, desc: "PPPoE_CAMPONOBRE_FLEXTEL" },
                    { id: 150, type: "smart", servPorts: 325, desc: "PPPoE_CAMPONOBRE_TOPNET" },
                    { id: 200, type: "smart", servPorts: 36, desc: "PPPoE_CAMPONOBRE_JPNET" },
                    { id: 999, type: "smart", servPorts: 0, desc: "GERENCIA" },
                    { id: 1005, type: "smart", servPorts: 174, desc: "PPPoE_CAMPONOBRE_CDLPLUS" },
                    { id: 1286, type: "smart", servPorts: 1, desc: "PPPoE_CAMPONOBRE_ALOPRIME" },
                    { id: 1287, type: "smart", servPorts: 0, desc: "CAMERAS_CAMPONOBRE_ALOPRIME" },
                    { id: 1332, type: "smart", servPorts: 11, desc: "PPPoE_CAMPONOBRE_LSFIBRA" },
                    { id: 1359, type: "smart", servPorts: 8, desc: "CVLAN_FREEWAY_ALL" },
                    { id: 1369, type: "smart", servPorts: 284, desc: "PPPoE_CAMPONOBRE_FREEWAY" },
                    { id: 1388, type: "smart", servPorts: 126, desc: "PPPoE_CAMPONOBRE_I9" },
                    { id: 1487, type: "smart", servPorts: 0, desc: "CVLAN_FREEWAY" },
                    { id: 3523, type: "smart", servPorts: 1, desc: "PPPoE_CAMPONOBRE_I9" },
                    { id: 3524, type: "smart", servPorts: 53, desc: "PPPoE_CAMPONOBRE_KSEFIBRA" },
                    { id: 3526, type: "smart", servPorts: 36, desc: "PPPoE_CAMPONOBRE_CAPITALNET" },
                    { id: 4014, type: "smart", servPorts: 16, desc: "PPPoE_CAMPONOBRE_CBNET" },
                    { id: 4015, type: "smart", servPorts: 33, desc: "PPPoE_CAMPONOBRE_WIFINET" },
                    { id: 4016, type: "smart", servPorts: 75, desc: "PPPoE_CAMPONOBRE_CONNECT" }
                ]
            },
            {
                name: "OLT-DAHMA-CONNECT",
                model: "HUAWEI",
                note: "display vlan all / desc. Possui VLAN QinQ.",
                vlans: [
                    { id: 1, type: "smart", servPorts: 0, desc: "Default" },
                    { id: 100, type: "smart", servPorts: 26, desc: "PPPoE_DAHMA_CONNECT" },
                    { id: 101, type: "smart", servPorts: 0, desc: "-" },
                    { id: 102, type: "smart", servPorts: 5, desc: "PPPoE_DAHMA_FLEXTEL" },
                    { id: 103, type: "smart", servPorts: 0, desc: "PPPoE_DAHMA_67INTERNET" },
                    { id: 104, type: "smart", servPorts: 0, desc: "PPPoE_DAHMA_JPNET" },
                    { id: 105, type: "smart", servPorts: 0, desc: "PPPoE_DAHMA_WIFINET" },
                    { id: 1000, type: "smart", servPorts: 0, desc: "GERENCIA" },
                    { id: 3690, type: "QinQ", servPorts: 22, desc: "-" }
                ]
            },
            {
                name: "OLT-JDPAULISTA-VIBE",
                model: "HUAWEI",
                note: "Baseado em 'display vlan all'. Descrições inferidas pelo padrão de ID de rede.",
                vlans: [
                    { id: 1, type: "smart", servPorts: 0, desc: "Default" },
                    { id: 150, type: "smart", servPorts: 0, desc: "TOPNET" },
                    { id: 201, type: "smart", servPorts: 12, desc: "JPNET" },
                    { id: 202, type: "smart", servPorts: 2, desc: "67INTERNET" },
                    { id: 203, type: "smart", servPorts: 6, desc: "FLEXTEL" },
                    { id: 204, type: "smart", servPorts: 0, desc: "WIFINET" },
                    { id: 205, type: "smart", servPorts: 7, desc: "CONNECT" },
                    { id: 999, type: "smart", servPorts: 0, desc: "GERENCIA" },
                    { id: 1282, type: "smart", servPorts: 0, desc: "Service" },
                    { id: 1283, type: "smart", servPorts: 0, desc: "Service" },
                    { id: 1339, type: "smart", servPorts: 1, desc: "Service" },
                    { id: 1359, type: "smart", servPorts: 0, desc: "CVLAN_FREEWAY_ALL" },
                    { id: 1371, type: "smart", servPorts: 1, desc: "Service" },
                    { id: 1381, type: "smart", servPorts: 15, desc: "Service" },
                    { id: 1488, type: "smart", servPorts: 1, desc: "CVLAN_FREEWAY" },
                    { id: 4014, type: "smart", servPorts: 7, desc: "CBNET" }
                ]
            },
            {
                name: "OLT-NOROESTE-VIBE",
                model: "HUAWEI",
                note: "display vlan all / desc.",
                vlans: [
                    { id: 1, type: "smart", servPorts: 0, desc: "Default" },
                    { id: 150, type: "smart", servPorts: 2, desc: "PPPoE_NOROESTE_TOPNET" },
                    { id: 201, type: "smart", servPorts: 35, desc: "PPPoE_NOROESTE_JPNET" },
                    { id: 202, type: "smart", servPorts: 7, desc: "PPPoE_NOROESTE_67INTERNET" },
                    { id: 203, type: "smart", servPorts: 3, desc: "PPPoE_NOROESTE_FLEXTEL" },
                    { id: 204, type: "smart", servPorts: 4, desc: "PPPoE_NOROESTE_WIFINET" },
                    { id: 205, type: "smart", servPorts: 6, desc: "PPPoE_NOROESTE_CONNECT" },
                    { id: 999, type: "smart", servPorts: 0, desc: "GERENCIA" },
                    { id: 1284, type: "smart", servPorts: 0, desc: "PPPoE_NOROESTE_ALOPRIME" },
                    { id: 1285, type: "smart", servPorts: 0, desc: "CAMERAS_NOROESTE_ALOPRIME" },
                    { id: 1338, type: "smart", servPorts: 0, desc: "PPPoE_NOROESTE_CDLPLUS" }
                ]
            },
            {
                name: "OLT-RITAVIEIRA-CONNECT",
                model: "HUAWEI",
                note: "Atualizado via CLI: display vlan all / display vlan desc",
                vlans: [
                    { id: 1, type: "smart", servPorts: 0, desc: "Default" },
                    { id: 100, type: "smart", servPorts: 954, desc: "PPPoE_RITAVIEIRA_CONNECT" },
                    { id: 102, type: "smart", servPorts: 181, desc: "PPPoE_RITAVIEIRA_FLEXTEL" },
                    { id: 103, type: "smart", servPorts: 7, desc: "PPPoE_RITAVIEIRA_67INTERNET" },
                    { id: 104, type: "smart", servPorts: 7, desc: "PPPoE_RITAVIEIRA_JPNET" },
                    { id: 105, type: "smart", servPorts: 12, desc: "PPPoE_RITAVIEIRA_WIFINET" },
                    { id: 150, type: "smart", servPorts: 54, desc: "PPPoE_RITAVIEIRA_TOPNET" },
                    { id: 1000, type: "smart", servPorts: 0, desc: "GERENCIA" },
                    { id: 1280, type: "smart", servPorts: 0, desc: "PPPoE_RITAVIEIRA_ALOPRIME" },
                    { id: 1281, type: "smart", servPorts: 0, desc: "CAMERAS_RITAVIEIRA_ALOPRIME" },
                    { id: 1331, type: "smart", servPorts: 8, desc: "PPPoE_RITAVIEIRA_LSFIBRA" },
                    { id: 1346, type: "smart", servPorts: 9, desc: "PPPoE_RITAVIEIRA_CDLPLUS" },
                    { id: 1359, type: "smart", servPorts: 6, desc: "CVLAN_FREEWAY_ALL" },
                    { id: 1368, type: "smart", servPorts: 79, desc: "PPPoE_RITAVIEIRA_FREEWAY" },
                    { id: 1395, type: "smart", servPorts: 7, desc: "PPPoE_RITAVIEIRA_I9" },
                    { id: 1488, type: "smart", servPorts: 1, desc: "CVLAN_FREEWAY" },
                    { id: 4014, type: "smart", servPorts: 7, desc: "PPPoE_RITAVIEIRA_CBNET" }
                ]
            }
        ];

        const OltCard = ({ olt, isPdf = false }) => {
            return (
                <div className={`bg-white rounded-xl border border-gray-200 overflow-hidden mb-6 break-inside-avoid ${isPdf ? 'pdf-mode' : 'shadow-sm fade-in hover:shadow-md transition-shadow'}`}>
                    <div className="bg-gray-50 px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                        <div className="flex items-center gap-3">
                            <div className={`p-2 rounded-lg ${olt.model === 'ZTE' ? 'bg-blue-100 text-blue-700' : 'bg-red-100 text-red-700'}`}>
                                <Icons.Server size={24} />
                            </div>
                            <div>
                                <h3 className="text-lg font-bold text-gray-800">{olt.name}</h3>
                                <span className="text-xs font-medium text-gray-500 bg-gray-200 px-2 py-0.5 rounded-full">{olt.model}</span>
                            </div>
                        </div>
                        <div className="text-right">
                            <span className="text-sm text-gray-500">Total VLANs</span>
                            <p className="text-xl font-bold text-gray-800">{olt.vlans.length}</p>
                        </div>
                    </div>
                    
                    <div className="p-6">
                        {olt.note && (
                            <div className="mb-4 p-3 bg-yellow-50 text-yellow-800 text-sm rounded-lg border border-yellow-200 flex items-center gap-2">
                                <Icons.Info size={16} />
                                {olt.note}
                            </div>
                        )}
                        <div className="overflow-x-auto">
                            <table className="w-full text-sm text-left">
                                <thead className="text-xs text-gray-500 uppercase bg-gray-50">
                                    <tr>
                                        <th className="px-4 py-3 rounded-l-lg">VLAN ID</th>
                                        <th className="px-4 py-3">Nome / Descrição</th>
                                        <th className="px-4 py-3 rounded-r-lg">
                                            {olt.model === 'HUAWEI' ? 'Service Ports (Criadas)' : 'Portas & Uplinks'}
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {olt.vlans.map((vlan, idx) => (
                                        <tr key={idx} className="border-b border-gray-100 hover:bg-gray-50">
                                            <td className="px-4 py-3 font-medium">
                                                <span className="bg-gray-100 text-gray-800 px-2.5 py-0.5 rounded border border-gray-300 font-mono">
                                                    {vlan.id}
                                                </span>
                                            </td>
                                            <td className="px-4 py-3">
                                                <div className="flex flex-col">
                                                    {/* Lógica Ajustada: Se não houver nome, usa a descrição como título principal */}
                                                    <span className="font-semibold text-gray-700">
                                                        {vlan.name || vlan.desc}
                                                    </span>
                                                    
                                                    {/* Só mostra a descrição secundária se o nome existir (para não duplicar a informação) */}
                                                    {vlan.name && (
                                                        <span className="text-xs text-gray-500">{vlan.desc}</span>
                                                    )}
                                                </div>
                                            </td>
                                            <td className="px-4 py-3 text-gray-600">
                                                {olt.model === 'HUAWEI' ? (
                                                    <div className="flex items-center gap-2">
                                                        <span className={`px-2 py-1 rounded-md text-xs font-bold ${vlan.servPorts > 0 ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-400'}`}>
                                                            {vlan.servPorts} SPs
                                                        </span>
                                                        {vlan.type && <span className="text-xs text-gray-400">({vlan.type})</span>}
                                                    </div>
                                                ) : (
                                                    <div className="flex flex-col gap-1">
                                                        {vlan.uplinks && vlan.uplinks[0] !== "N/A" && (
                                                            <div className="flex items-center gap-1 text-xs text-indigo-600">
                                                                <Icons.ArrowUpCircle size={12} />
                                                                {vlan.uplinks.join(", ")}
                                                            </div>
                                                        )}
                                                        <div className="text-xs text-gray-500 flex items-center gap-1">
                                                            <Icons.Network size={12} />
                                                            {vlan.gpon}
                                                        </div>
                                                    </div>
                                                )}
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('zte');
            const [isGenerating, setIsGenerating] = useState(false);

            const handleDownloadPDF = () => {
                setIsGenerating(true);
                const element = document.getElementById('full-report-pdf');
                
                // Configurações otimizadas para garantir renderização
                const opt = {
                    margin: 10,
                    filename: 'Relatorio_Completo_OLTs.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2, 
                        logging: true, 
                        useCORS: true,
                        // windowWidth garante que o layout responsive não quebre
                        windowWidth: 1024 
                    },
                    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
                    pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
                };

                html2pdf().from(element).set(opt).save().then(() => {
                    setIsGenerating(false);
                }).catch(err => {
                    console.error("PDF generation failed:", err);
                    setIsGenerating(false);
                    alert("Erro ao gerar PDF.");
                });
            };

            return (
                <div className="min-h-screen pb-10">
                    {/* Header */}
                    <header className="bg-white border-b border-gray-200 sticky top-0 z-10">
                        <div className="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="bg-indigo-600 p-2 rounded-lg text-white">
                                    <Icons.Activity size={24} />
                                </div>
                                <h1 className="text-xl font-bold text-gray-800">Monitoramento de OLTs</h1>
                            </div>
                            <div className="flex items-center gap-3">
                                <span className="text-sm text-gray-500 hidden md:block">
                                    Dados processados dos arquivos de log
                                </span>
                                <button 
                                    onClick={handleDownloadPDF}
                                    disabled={isGenerating}
                                    className="flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    {isGenerating ? <Icons.Loader2 size={18} className="animate-spin" /> : <Icons.Download size={18} />}
                                    {isGenerating ? "Gerando..." : "Baixar PDF Completo"}
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-6xl mx-auto px-4 mt-8">
                        
                        {/* Summary Cards */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                                <div className="text-sm text-gray-500 mb-1">Total OLTs Analisadas</div>
                                <div className="text-2xl font-bold text-gray-800">{zteData.length + huaweiData.length}</div>
                            </div>
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                                <div className="text-sm text-gray-500 mb-1">OLTs ZTE</div>
                                <div className="text-2xl font-bold text-blue-600">{zteData.length}</div>
                            </div>
                            <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-200">
                                <div className="text-sm text-gray-500 mb-1">OLTs HUAWEI</div>
                                <div className="text-2xl font-bold text-red-600">{huaweiData.length}</div>
                            </div>
                        </div>

                        {/* Tabs */}
                        <div className="flex gap-4 mb-6 border-b border-gray-200">
                            <button 
                                onClick={() => setActiveTab('zte')}
                                className={`pb-3 px-4 font-medium transition-colors relative ${activeTab === 'zte' ? 'text-blue-600' : 'text-gray-500 hover:text-gray-700'}`}
                            >
                                <div className="flex items-center gap-2">
                                    <Icons.Cpu size={18} />
                                    ZTE Devices
                                </div>
                                {activeTab === 'zte' && <div className="absolute bottom-0 left-0 w-full h-0.5 bg-blue-600"></div>}
                            </button>
                            <button 
                                onClick={() => setActiveTab('huawei')}
                                className={`pb-3 px-4 font-medium transition-colors relative ${activeTab === 'huawei' ? 'text-red-600' : 'text-gray-500 hover:text-gray-700'}`}
                            >
                                <div className="flex items-center gap-2">
                                    <Icons.Box size={18} />
                                    Huawei Devices
                                </div>
                                {activeTab === 'huawei' && <div className="absolute bottom-0 left-0 w-full h-0.5 bg-red-600"></div>}
                            </button>
                        </div>

                        {/* Content Area */}
                        <div>
                            {activeTab === 'zte' && (
                                <div className="space-y-6">
                                    {zteData.map((olt, index) => (
                                        <OltCard key={index} olt={olt} />
                                    ))}
                                </div>
                            )}

                            {activeTab === 'huawei' && (
                                <div className="space-y-6">
                                    {huaweiData.map((olt, index) => (
                                        <OltCard key={index} olt={olt} />
                                    ))}
                                </div>
                            )}
                        </div>
                    </main>

                    {/* Hidden Container for Full PDF Generation */}
                    <div id="full-report-pdf" className="pdf-hidden-container p-8 pdf-mode">
                        <div className="mb-8 border-b pb-4">
                            <h1 className="text-2xl font-bold text-gray-800">Relatório Completo de OLTs</h1>
                            <p className="text-gray-500">Documento gerado automaticamente.</p>
                        </div>
                        
                        <div className="mb-8">
                            <h2 className="text-xl font-bold text-blue-700 mb-4 border-b border-blue-200 pb-2">Dispositivos ZTE</h2>
                            <div className="space-y-6">
                                {zteData.map((olt, index) => (
                                    <OltCard key={`zte-${index}`} olt={olt} isPdf={true} />
                                ))}
                            </div>
                        </div>

                        <div className="page-break"></div>

                        <div>
                            <h2 className="text-xl font-bold text-red-700 mb-4 border-b border-red-200 pb-2">Dispositivos HUAWEI</h2>
                            <div className="space-y-6">
                                {huaweiData.map((olt, index) => (
                                    <OltCard key={`huawei-${index}`} olt={olt} isPdf={true} />
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const rootElement = document.getElementById('root');
        if (rootElement) {
            ReactDOM.createRoot(rootElement).render(<App />);
        } else {
            console.error("Root element not found");
        }
    </script>
</body>
</html>
