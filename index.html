from reportlab.lib import colors
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Table, TableStyle, Paragraph, Spacer
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle

# Nome do arquivo de saída
filename = "Relatorio_VLANs_OLTs.pdf"

# Dados extraídos do relatório (Conforme texto fornecido)
data = {
    "1. OLT ZTE JD AEROPORTO": [
        ["1040", "PPPoE_NETWARE", "PPPoE_JDAEROPORTO_NETWARE"],
        ["1343", "PPPoE_CDLPLUS", "PPPoE_JDAEROPORTO_CDLPLUS"]
    ],
    "2. OLT CAIÇARA (67INTERNET)": [
        ["150", "PPPoE_TOPNET", "PPPoE_CAICARA_TOPNET"],
        ["1347", "PPPoE_CDLPLUS", "PPPoE_CAICARA_CDLPLUS"],
        ["1394", "PPPoE_I9", "PPPoE_I9_CAICARA"]
    ],
    "3. OLT JD INÁPOLIS (FLEXTEL)": [
        ["150", "PPPoE_TOPNET", "PPPoE_JDINAPOLIS_TOPNET"],
        ["1345", "PPPoE_CDLPLUS", "PPPoE_JDINAPOLIS_CDLPLUS"],
        ["1397", "PPPoE_I9", "PPPoE_JDINAPOLIS_I9"],
        ["4009", "VLAN4009", "N/A"],
        ["4014", "PPPoE_CBNET", "PPPoE_JDINAPOLIS_CBNET"]
    ],
    "4. OLT JD TIJUCA (FLEXTEL)": [
        ["150", "PPPoE_TOPNET", "PPPoE_JDTIJUCA_TOPNET"]
    ],
    "5. OLT NASSER (WIFINET)": [
        ["150", "PPPoE_TOPNET", "PPPoE_NASSER_TOPNET"],
        ["1341", "PPPoE_CDLPLUS", "PPPoE_NASSER_CDLPLUS"]
    ],
    "6. OLT NCG (WIFINET)": [
        ["150", "PPPoE_TOPNET", "PPPoE_NCG_TOPNET"],
        ["1040", "PPPoE_NETWARE", "PPPoE_NCG_NETWARE"],
        ["1344", "PPPoE_CDLPLUS", "PPPoE_NCG_CDLPLUS"]
    ],
    "7. OLT JD PAULISTA (VIBE / HUAWEI)": [
        ["150", "PPPoE_TOPNET", "PPPoE_TOPNET_JDPAULISTA"],
        ["201", "PPPoE_JPNET", "PPPoE_JDPAULISTA_JPNET"],
        ["202", "PPPoE_67INTERNET", "PPPoE_JDPAULISTA_67INTERNET"],
        ["203", "PPPoE_FLEXTEL", "PPPoE_JDPAULISTA_FLEXTEL"],
        ["204", "PPPoE_WIFINET", "PPPoE_JDPAULISTA_WIFINET"],
        ["205", "PPPoE_CONNECT", "PPPoE_JDPAULISTA_CONNECT"],
        ["999", "GERENCIA", "GERENCIA"],
        ["1282", "PPPoE_ALOPRIME", "PPPoE_JDPAULISTA_ALOPRIME"],
        ["1283", "CAMERAS_ALOPRIME", "CAMERAS_JDPAULISTA_ALOPRIME"],
        ["1339", "PPPoE_CDLPLUS", "PPPoE_JDPAULISTA_CDLPLUS"],
        ["1359", "CVLAN_FREEWAY", "CVLAN_FREEWAY_ALL"],
        ["1371", "PPPoE_FREEWAY", "PPPoE_JDPAULISTA_FREEWAY"],
        ["1381", "PPPoE_VIBE", "PPPoE_JDPAULISTA_VIBE"],
        ["1389", "PPPoE_I9", "PPPoE_JDPAULISTA_I9"]
    ],
    "8. OLT RITA VIEIRA (CONNECT / HUAWEI)": [
        ["100", "PPPoE_RITAVIEIRA_CONNECT", "-"],
        ["102", "PPPoE_RITAVIEIRA_FLEXTEL", "-"],
        ["103", "PPPoE_RITAVIEIRA_67INTERNET", "-"],
        ["104", "PPPoE_RITAVIEIRA_JPNET", "-"],
        ["105", "PPPoE_RITAVIEIRA_WIFINET", "-"],
        ["150", "PPPoE_RITAVIEIRA_TOPNET", "-"],
        ["1000", "GERENCIA", "-"],
        ["1280", "PPPoE_RITAVIEIRA_ALOPRIME", "-"]
    ],
    "9. OLT STA EMILIA (FLEXTEL)": [
        ["150", "PPPoE_TOPNET", "PPPoE_STAEMILIA_TOPNET"],
        ["4014", "PPPoE_CBNET", "PPPoE_STAEMILIA_CBNET"]
    ],
    "10. OLT STO AMARO (67INTERNET)": [
        ["150", "PPPoE_TOPNET", "PPPoE_STOAMARO_TOPNET"],
        ["1342", "PPPoE_CDLPLUS", "PPPoE_STOAMARO_CDLPLUS"],
        ["1393", "PPPoE_I9", "PPPoE_STOAMARO_I9"]
    ]
}

# Configuração do documento
doc = SimpleDocTemplate(filename, pagesize=letter)
elements = []
styles = getSampleStyleSheet()

# Estilo do Título
title_style = styles['Title']
title_style.alignment = 1 # Center
elements.append(Paragraph("Relatório de Configuração de VLANs por OLT", title_style))
elements.append(Spacer(1, 20))

# Estilo das Tabelas
table_style = TableStyle([
    ('BACKGROUND', (0, 0), (-1, 0), colors.Color(0.2, 0.4, 0.6)), # Azul escuro no cabeçalho
    ('TEXTCOLOR', (0, 0), (-1, 0), colors.whitesmoke),
    ('ALIGN', (0, 0), (-1, -1), 'LEFT'),
    ('FONTNAME', (0, 0), (-1, 0), 'Helvetica-Bold'),
    ('BOTTOMPADDING', (0, 0), (-1, 0), 12),
    ('BACKGROUND', (0, 1), (-1, -1), colors.Color(0.95, 0.95, 0.95)), # Cinza claro nas linhas
    ('GRID', (0, 0), (-1, -1), 1, colors.black),
    ('FONTSIZE', (0, 0), (-1, -1), 10),
    ('VALIGN', (0, 0), (-1, -1), 'MIDDLE'),
])

# Cabeçalho das tabelas
headers = ["VLAN ID", "Nome", "Descrição"]

for olt_name, vlans in data.items():
    # Título da Seção (OLT)
    elements.append(Paragraph(olt_name, styles['Heading2']))
    elements.append(Spacer(1, 6))
    
    # Preparar dados da tabela
    table_data = [headers] + vlans
    
    # Criar tabela (largura fixa para evitar quebras ruins)
    t = Table(table_data, colWidths=[60, 200, 250])
    t.setStyle(table_style)
    
    elements.append(t)
    elements.append(Spacer(1, 18))

# Construir PDF
doc.build(elements)

print(f"PDF gerado com sucesso: {filename}")
